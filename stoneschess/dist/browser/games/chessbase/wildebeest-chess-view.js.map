{"version":3,"names":[],"mappings":"","sources":["wildebeest-view.js"],"sourcesContent":["/*\n * Copyright(c) 2013-2014 - jocly.com\n *\n * You are allowed to use and modify this source code as long as it is exclusively for use in the Jocly API. \n *\n * Original authors: Jocly team\n *\n */\n \n\n(function() {\n\t\n\tView.Game.cbDefineView = function() {\n\n\t\tvar wildebeestBoardDelta = {\n//\t\t\tnotationMode: 'in',\n//\t\t\tnotationDebug: true,\n\t\t};\t\t\n\t\tvar wildebeestBoard3d = $.extend(true,{},this.cbGridBoardClassic3DMargin,wildebeestBoardDelta);\n\t\tvar wildebeestBoard2d = $.extend(true,{},this.cbGridBoardClassic2DNoMargin,wildebeestBoardDelta);\n\t\t\n\t\treturn {\n\t\t\tcoords: {\n\t\t\t\t\"2d\": this.cbGridBoard.coordsFn.call(this,wildebeestBoard2d),\n\t\t\t\t\"3d\": this.cbGridBoard.coordsFn.call(this,wildebeestBoard3d),\n\t\t\t},\n\t\t\tboardLayout: [\n\t      \t\"#.#.#.#.#.#\",\n\t      \t\t\".#.#.#.#.#.\",\n\t     \t\t\"#.#.#.#.#.#\",\n\t      \t\t\".#.#.#.#.#.\",\n\t     \t\t\"#.#.#.#.#.#\",\n\t      \t\t\".#.#.#.#.#.\",\n\t     \t\t\"#.#.#.#.#.#\",\n\t      \t\t\".#.#.#.#.#.\",\n\t     \t\t\"#.#.#.#.#.#\",\n\t\t\t\t\".#.#.#.#.#.\",\n\t\t\t],\n\t\t\tboard: {\n\t\t\t\t\"2d\": {\n\t\t\t\t\tdraw: this.cbDrawBoardFn(wildebeestBoard2d),\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t},\n\t\t\t\t\"3d\": {\n\t\t\t\t\tdisplay: this.cbDisplayBoardFn(wildebeestBoard3d),\t\t\t\t\t\n\t\t\t\t},\n\t\t\t},\n\t\t\tclicker: {\n\t\t\t\t\"2d\": {\n\t\t\t\t\twidth: 1100,\n\t\t\t\t\theight: 1100,\n\t\t\t\t},\n\t\t\t\t\"3d\": {\n\t\t\t\t\tscale: [.7,.7,.7],\n\t\t\t\t},\n\t\t\t},\n\t\t\tpieces: this.cbFairyPieceStyle({\n\t\t\t\t\"default\": {\n\t\t\t\t\t\"3d\": {\n\t\t\t\t\t\tscale: [.45,.45,.45],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t};\n\t}\n\n\t/* Make the knight, camel and wildebeest jump when leaping */\n\tView.Board.cbMoveMidZ = function(aGame,aMove,zFrom,zTo) {\n\t\tvar geometry = aGame.cbVar.geometry;\n\t\tvar x0 = geometry.C(aMove.f);\n\t\tvar x1 = geometry.C(aMove.t);\n\t\tvar y0 = geometry.R(aMove.f);\n\t\tvar y1 = geometry.R(aMove.t);\n\t\tif(x1-x0==0 || y1-y0==0 || Math.abs(x1-x0)==Math.abs(y1-y0))\n\t\t\treturn (zFrom+zTo)/2;\n\t\telse\n\t\t\treturn Math.max(zFrom,zTo)+1500;\n\t}\n\n\tvar SuperViewBoardcbAnimate = View.Board.cbAnimate;\n\tView.Board.cbAnimate = function(xdv,aGame,aMove,callback) {\n\n\t\tvar piece=this.pieces[this.board[aMove.f]];\n\t\tif(piece.t==8 && !this.castled[this.mWho] && aMove.cg===undefined) {\n\t\t\tvar geometry = aGame.cbVar.geometry;\n\t\t\tvar dc=Math.abs(geometry.C(aMove.t)-geometry.C(aMove.f));\n\t\t\tif(dc>=2) {\n\t\t\t\tvar extra=aGame.wbExtraCastleRook[aMove.t];\n\t\t\t\tvar rPiece=this.pieces[this.board[extra.r0]];\n\n\t\t\t\tvar animCount=2;\n\t\t\t\tfunction EndAnim() {\n\t\t\t\t\tif(--animCount==0)\n\t\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t\tSuperViewBoardcbAnimate.call(this,xdv,aGame,aMove,function() {\n\t\t\t\t\tEndAnim();\n\t\t\t\t});\n\t\t\t\tvar displaySpec=aGame.cbMakeDisplaySpecForPiece(aGame,extra.r,rPiece);\n\t\t\t\txdv.updateGadget(\"piece#\"+rPiece.i,displaySpec,600,function() {\n\t\t\t\t\tEndAnim();\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tSuperViewBoardcbAnimate.apply(this,arguments);\n\t}\n\n})();\n"],"file":"wildebeest-chess-view.js"}